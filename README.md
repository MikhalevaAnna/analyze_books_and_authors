# Провести анализ данных по авторам и книгам с пмощью PySpark

Есть два набора данных: информация о книгах и информация об авторах. <br>
Нужно объединить эти данные и провести анализ, чтобы найти различные статистики о книгах и авторах.

## Данные
### Таблица `books`:

`book_id`: ID книги <br>
`title`: Название книги <br>
`author_id`: ID автора <br>
`genre`: Жанр книги <br>
`price`: Цена книги <br>
`publish_date`: Дата публикации (в формате YYYY-MM-DD) <br>

### Таблица authors:

`author_id`: ID автора <br>
`name`: Имя автора <br>
`birth_date`: Дата рождения автора (в формате YYYY-MM-DD) <br>
`country`: Страна автора <br>

## Выполняем следующие пункты по порядку:

### 1.Чтение данных:

Загружаем данные из **CSV** файлов в **DataFrame**. <br>
**CSV** файл `books` можно скачать по ссылке - [https://disk.yandex.ru/d/7ObST0hRb5E4qA](https://disk.yandex.ru/d/uAFqLYZR41-z9Q) , 
а `authors` по ссылке - [https://disk.yandex.ru/d/q4K_cpm1rAamhA](https://disk.yandex.ru/d/q4K_cpm1rAamhA)

### 2. Обработка данных:

Преобразуем столбцы **publish_date** и **birth_date** в формат даты. 
### 3. Объединение данных:

Объединим таблицы `books` и `authors` по **author_id**.
### 4. Анализ данных:

4.1 Найдем топ-5 авторов, книги которых принесли наибольшую выручку. <br>
4.2 Найдем количество книг в каждом жанре. <br>
4.3 Подсчитаем среднюю цену книг по каждому автору. <br>
4.4 Найдем книги, опубликованные после 2000 года, и отсортируйте их по цене. <br>

### 5. Результаты:

## Выведим результаты анализа в виде таблиц:
### Результат 4.1
```
+---------+--------+-------+
|author_id|    name|revenue|
+---------+--------+-------+
|        2|Author_2| 231.97|
|        7|Author_7| 132.66|
|        1|Author_1| 111.86|
|        8|Author_8| 107.16|
|        5|Author_5|  88.83|
+---------+--------+-------+
```
### Результат 4.2
```
+-----------+-----+
|      genre|count|
+-----------+-----+
|Non-Fiction|    9|
|    Science|    3|
|    Fiction|    3|
|    Fantasy|    3|
|    Mystery|    2|
+-----------+-----+
```
### Результат 4.3
```
+---------+---------+---------+
|author_id|     name|avg_price|
+---------+---------+---------+
|        5| Author_5|    88.83|
|        4| Author_4|     83.7|
|        2| Author_2|    57.99|
|        9| Author_9|    46.31|
|        7| Author_7|    44.22|
|        6| Author_6|    43.97|
|        1| Author_1|    37.29|
|        8| Author_8|    35.72|
|       10|Author_10|    21.17|
+---------+---------+---------+
```
### Результат 4.4
```
+---------+-------+-------+-----------+-----+------------+--------+----------+---------+
|author_id|book_id|  title|      genre|price|publish_date|    name|birth_date|  country|
+---------+-------+-------+-----------+-----+------------+--------+----------+---------+
|        7|     20|Book_20|    Mystery|91.48|  2018-12-31|Author_7|1990-12-31|      USA|
|        5|     19|Book_19|    Science|88.83|  2016-12-31|Author_5|1980-12-31|      USA|
|        8|     15|Book_15|    Fantasy| 60.0|  2008-12-31|Author_8|1995-12-31|Australia|
|        6|     17|Book_17|    Fantasy|47.57|  2012-12-31|Author_6|1985-12-31|      USA|
|        1|     18|Book_18|Non-Fiction|43.92|  2014-12-31|Author_1|1960-12-31|    India|
|        2|     16|Book_16|    Fiction|36.22|  2010-12-31|Author_2|1965-12-31|   Canada|
|        8|     12|Book_12|Non-Fiction|31.02|  2002-12-31|Author_8|1995-12-31|Australia|
|        1|     14|Book_14|    Fiction|26.84|  2006-12-31|Author_1|1960-12-31|    India|
|        8|     13|Book_13|Non-Fiction|16.14|  2004-12-31|Author_8|1995-12-31|Australia|
+---------+-------+-------+-----------+-----+------------+--------+----------+---------+
```
